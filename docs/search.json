[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Sophie Meakin Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/example-application.html","id":"model","dir":"Articles","previous_headings":"","what":"Model","title":"Example application: the effect of post-exposure prophylaxis for high-risk contacts on outbreak control","text":"First, define grid scenarios parameters interest: Probability high-risk contact receives PEP = {0.2, 0.6, 1}; Effectiveness PEP (relative risk becoming case) = {0, 0.1, 0.2, …, 0.9, 1}. parameters fixed. mean number high-risk contacts 2 probability high-risk contact becomes case (without PEP) 0.75. mean number low-risk contacts 5 probability low-risk contact becomes case 0.1. Now run 100 iterations branching process model scenario, summarise results:","code":"scenario_grid <- expand_grid(   # Varying parameters   prop_pep = seq(0.2, 1, 0.4),   rel_risk = seq(0, 1, 0.1),   # Fixed parameters   n_initialcases = 5,   hrc_mu = 2,   hrc_disp = 1,   lrc_mu = 5,   lrc_disp = 10,   p_hrc_case = 0.75,   p_lrc_case = 0.1 ) %>%   mutate(scenario = 1:n()) %>%   select(scenario, everything()) res <- parameter_sweep(   scenarios = scenario_grid,   n_sim = 100,   sim_fn = partial(scenario_sim, cap_max_gen = 5, cap_max_cases = 2500) )  res_summary <- summarise_results(res) %>%   group_by(scenario) %>%   mutate(big50 = sum(outbreak_size > 50)/n()) %>%   right_join(scenario_grid, by = \"scenario\") %>%   ungroup()"},{"path":[]},{"path":"/articles/example-application.html","id":"effect-of-pep-on-preventing-large-outbreaks","dir":"Articles","previous_headings":"Results","what":"Effect of PEP on preventing large outbreaks","title":"Example application: the effect of post-exposure prophylaxis for high-risk contacts on outbreak control","text":"","code":"res_summary %>%   filter(prop_pep > 0) %>%   select(scenario, prop_pep, rel_risk, big50) %>%   distinct() %>%   ggplot(aes(x = rel_risk, y = big50, col = as.factor(prop_pep))) +   geom_point(size = 3) +   geom_line() +   scale_x_continuous(breaks = seq(0, 1, 0.2)) +   scale_y_continuous(breaks = seq(0, 1, 0.2)) +   scale_color_brewer(palette = \"Reds\") +   labs(     x = \"Relative risk of HRCs becoming a case (PEP vs. no PEP)\", y = \"Proportion of outbreaks with at least 50 cases\",     col = \"Probability of receiving PEP\"   ) +   theme_bw() +   theme(text = element_text(size = 16), legend.position = \"top\")"},{"path":"/articles/example-application.html","id":"effect-of-pep-on-r0-in-large-outbreaks","dir":"Articles","previous_headings":"Results","what":"Effect of PEP on R0 in large outbreaks","title":"Example application: the effect of post-exposure prophylaxis for high-risk contacts on outbreak control","text":"","code":"plot_r0(res_summary[which(res_summary$outbreak_size > 50),])"},{"path":"/articles/example-application.html","id":"number-of-pep-doses-required","dir":"Articles","previous_headings":"Results","what":"Number of PEP doses required","title":"Example application: the effect of post-exposure prophylaxis for high-risk contacts on outbreak control","text":"","code":"res_summary %>%   filter(prop_pep > 0) %>%   group_by(scenario, n_initialcases, prop_pep, rel_risk) %>%   summarise(     npep_mean = mean(n_pep),     npep_median = median(n_pep),     npep_q025 = quantile(n_pep, 0.025),     npep_q25 = quantile(n_pep, 0.25),     npep_q75 = quantile(n_pep, 0.75),     npep_q975 = quantile(n_pep, 0.975),     .groups = \"drop\"   ) %>%   ggplot(aes(x = rel_risk, col = as.factor(prop_pep))) +   geom_ribbon(aes(ymin = npep_q25, ymax = npep_q75, fill = as.factor(prop_pep)), col = NA, alpha = 0.4) +   geom_point(aes(y = npep_mean), size = 3) +   geom_line(aes(y = npep_mean)) +   scale_x_continuous(breaks = seq(0, 1, 0.2)) +   scale_y_continuous(limits = c(0, NA)) +   scale_color_brewer(palette = \"Reds\") +   scale_fill_brewer(palette = \"Reds\") +   labs(     x = \"Relative risk of becoming a case\", y = \"Number of PEP doses\",     col = \"Probability of receiving PEP\", fill = \"Probability of receiving PEP\"   ) +   theme_bw() +   theme(text = element_text(size = 16), legend.position = \"top\")"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sophie Meakin. Author, maintainer. Joel Hellewell. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Meakin S, Hellewell J (2024). pepbp: Simulating infectious disease outbreak post-exposure prophylaxis high-risk contacts. R package version 0.0.0.9000.","code":"@Manual{,   title = {pepbp: Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts},   author = {Sophie Meakin and Joel Hellewell},   year = {2024},   note = {R package version 0.0.0.9000}, }"},{"path":"/index.html","id":"pepbp-simulating-an-infectious-disease-outbreak-with-post-exposure-prophylaxis-for-high-risk-contacts","dir":"","previous_headings":"","what":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"pepbp package simulate infectious disease outbreak high-risk contacts cases receive post-exposure prophylaxis, reduces probability becoming case. See Methods full description underlying branching process model. installation quick-start guide package .","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"can install package Github:","code":"devtools::install_github(\"sophiemeakin/pepbp\")"},{"path":"/index.html","id":"quick-start-guide","dir":"","previous_headings":"","what":"Quick start guide","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"main functionality package scenario_sim(). example run five iterations given scenario: can , example, plot total cases generation:  See vignettes/example-application.Rmd application model explore effect post-exposure prophylaxis high-risk contacts transmission control infectious disease outbreak.","code":"res <- scenario_sim(   n_sim = 5,            # number of iterations   prop_pep = 0.8,       # probability that high-risk contacts (HRCs) receive PEP   rel_risk = 0.5,       # relative risk of becoming a case after receiving PEP   hrc_mu = 2,           # average number of HRCs per case   hrc_disp = 1,         # overdispersion of number of HRCs   lrc_mu = 5,           # average number of low-risk contacts (LRCs) per case   lrc_disp = 10,        # overdispersion of number of LRCs   p_hrc_case = 0.75,    # probability that HRCs become a case (without PEP)   p_lrc_case = 0.1,     # probability that LRCs become a case   n_initialcases = 5,   # number of initial cases   cap_max_gen = 10,     # BP stopping criteria, generations   cap_max_cases = Inf   # BP stopping criteria, total cases ) res %>%   count(iter, generation) %>%   complete(iter, generation, fill = list(n = 0)) %>%   group_by(iter) %>%   mutate(n_cuml = cumsum(n)) %>%   ggplot(aes(x = generation, y = n_cuml, col = as.factor(iter))) +   geom_line(show.legend = FALSE) +   scale_x_continuous(limits = c(0, NA), breaks = seq(0, 10, 2)) +   scale_y_continuous(limits = c(0, NA), breaks = seq(0, 5000, 200)) +   scale_color_brewer(palette = \"Set2\") +   labs(x = \"Generation\", y = \"Cumulative cases\") +   theme_bw() +   theme(text = element_text(size = 14))"},{"path":[]},{"path":"/index.html","id":"input","dir":"","previous_headings":"Methods","what":"Input","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"branching process model five inputs: initial number cases, n. distribution number high- low-risk contacts per case. probability high- low-risk contacts become cases, q_HR q_LR, respectively. probability high-risk contact receives PEP, p. effectiveness PEP, defined relative risk high-risk contact becomes case receiving PEP, theta.","code":""},{"path":"/index.html","id":"model","dir":"","previous_headings":"Methods","what":"Model","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"outbreak initialised n cases. , case: Generate contacts: Sample number high- low-risk contacts respective negative binomial distributions. Assign PEP high-risk contacts: high-risk contact receives PEP probability p. High-risk contacts receive PEP become cases probability q_HR. High-risk contacts receive PEP become cases probability theta*q_HR. Low-risk contacts become cases probability q_LR. Repeat 1 - 3 new generation cases.","code":""},{"path":"/index.html","id":"output","dir":"","previous_headings":"Methods","what":"Output","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"output row represents case, report following: number high- low-risk contacts number high-risk contacts receive PEP number secondary cases (high-risk contacts received PEP; high-risk contacts receive PEP; low-risk contacts)","code":""},{"path":"/index.html","id":"acknowledgements","dir":"","previous_headings":"","what":"Acknowledgements","title":"Simulating an infectious disease outbreak with post-exposure prophylaxis for high-risk contacts","text":"structure {pepbp} based {ringbp} package, originally developed Joel Hellewell, Sam Abbott, Amy Gimma, Tim Lucas Sebastian Funk. Thank !","code":""},{"path":"/reference/outbreak_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PEP branching process model — outbreak_model","title":"Run PEP branching process model — outbreak_model","text":"Run single instance branching process model post-exposure prophylaxis high-risk contacts. See Details full description branching process model.","code":""},{"path":"/reference/outbreak_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PEP branching process model — outbreak_model","text":"","code":"outbreak_model(   prop_pep,   rel_risk,   hrc_mu,   hrc_disp,   lrc_mu,   lrc_disp,   p_hrc_case,   p_lrc_case,   n_initialcases,   cap_max_gen,   cap_max_cases )"},{"path":"/reference/outbreak_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PEP branching process model — outbreak_model","text":"prop_pep Proportion high-risk contacts receive PEP rel_risk Relative risk high-risk contact becoming case receiving PEP hrc_mu Average number high-risk contacts hrc_disp Dispersion parameter number high-risk contacts lrc_mu Average number low-risk contacts lrc_disp Dispersion parameter number low-risk contacts p_hrc_case Probability high-risk contact becomes case p_lrc_case Probability low-risk contact becomes case n_initialcases Integer number initial cases cap_max_gen Stop simulation many generations reached cap_max_cases Stop simulation many cases reached","code":""},{"path":"/reference/outbreak_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PEP branching process model — outbreak_model","text":"data.frame cases generation, columns: generation case_id case_type: one \"PEP\", \"HRC\" (PEP), \"LRC\". infector: case_id infector (currently used) new_cases: total new cases new_cases_hrc: new cases high-risk contacts new_cases_pep: new cases high-risk contacts received PEP new_cases_lrc: new cases low-risk contacts n_hrc: number high-risk contacts receive PEP n_pep: number high-risk contacts received PEP n_lrc: number low-risk contacts","code":""},{"path":"/reference/outbreak_model.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PEP branching process model — outbreak_model","text":"outbreak begins given number initial cases. case number high- low-risk contacts, defined negative binomial distribution. fixed proportion prop_pep high-risk contacts receive PEP. High-risk contacts receive PEP become cases probability p_hrc_case; high-risk contacts receive PEP become cases lower probability p_hrc_case*rel_risk. Low-risk contacts receive PEP, become cases probability p_lrc_case.","code":""},{"path":"/reference/outbreak_model.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run PEP branching process model — outbreak_model","text":"Sophie Meakin, Joel Hellewell","code":""},{"path":"/reference/outbreak_setup.html","id":null,"dir":"Reference","previous_headings":"","what":"Set up initial cases for branching process — outbreak_setup","title":"Set up initial cases for branching process — outbreak_setup","text":"Set initial cases branching process","code":""},{"path":"/reference/outbreak_setup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set up initial cases for branching process — outbreak_setup","text":"","code":"outbreak_setup(n_initialcases)"},{"path":"/reference/outbreak_setup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set up initial cases for branching process — outbreak_setup","text":"n_initialcases Integer number initial cases","code":""},{"path":"/reference/outbreak_setup.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set up initial cases for branching process — outbreak_setup","text":"data.frame initial cases outbreak; pass pepbp::outbreak_step().","code":""},{"path":"/reference/outbreak_setup.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Set up initial cases for branching process — outbreak_setup","text":"Sophie Meakin, Joel Hellewell","code":""},{"path":"/reference/outbreak_step.html","id":null,"dir":"Reference","previous_headings":"","what":"Move branching process forward by one generation — outbreak_step","title":"Move branching process forward by one generation — outbreak_step","text":"Move branching process model forward generation g generation g+1.","code":""},{"path":"/reference/outbreak_step.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Move branching process forward by one generation — outbreak_step","text":"","code":"outbreak_step(   case_data,   g,   hrc_mu,   hrc_disp,   lrc_mu,   lrc_disp,   prop_pep,   rel_risk,   p_hrc_case,   p_lrc_case )"},{"path":"/reference/outbreak_step.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Move branching process forward by one generation — outbreak_step","text":"hrc_mu Average number high-risk contacts hrc_disp Dispersion parameter number high-risk contacts lrc_mu Average number low-risk contacts lrc_disp Dispersion parameter number low-risk contacts prop_pep Proportion high-risk contacts receive PEP rel_risk Relative risk high-risk contact becoming case receiving PEP p_hrc_case Probability high-risk contact becomes case p_lrc_case Probability low-risk contact becomes case outbreak_data data.frame cases generation g+1.","code":""},{"path":"/reference/outbreak_step.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Move branching process forward by one generation — outbreak_step","text":"data.frame updated one new generation cases.","code":""},{"path":"/reference/outbreak_step.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Move branching process forward by one generation — outbreak_step","text":"Sophie Meakin, Joel Hellewell","code":""},{"path":"/reference/parameter_sweep.html","id":null,"dir":"Reference","previous_headings":"","what":"Sweep across parameters — parameter_sweep","title":"Sweep across parameters — parameter_sweep","text":"Explore scenarios using gridding sampling parameters grid. Parameters included grid currently hard coded. Use future package control parallisation outside function.","code":""},{"path":"/reference/parameter_sweep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sweep across parameters — parameter_sweep","text":"","code":"parameter_sweep(   scenarios = NULL,   n_sim = 1,   sim_fn = NULL,   show_progress = TRUE )"},{"path":"/reference/parameter_sweep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sweep across parameters — parameter_sweep","text":"scenarios data.frame containing gridded scenarios. n_sim number simulations make per scenario. Numeric, defaults 1. sim_fn vectorised model simulation function. show_progress Show progress parameter sweep. Logical, defaults TRUE.","code":""},{"path":"/reference/parameter_sweep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sweep across parameters — parameter_sweep","text":"nested tibble containing parameters scenario nested list output sim_fn.","code":""},{"path":"/reference/parameter_sweep.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Sweep across parameters — parameter_sweep","text":"Sam Abbott, Sophie Meakin, Joel Hellewell","code":""},{"path":"/reference/plot_r0.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualise change in R0 — plot_r0","title":"Visualise change in R0 — plot_r0","text":"Visualise relative risk becoming case versus average number secondary cases.","code":""},{"path":"/reference/plot_r0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualise change in R0 — plot_r0","text":"","code":"plot_r0(sweep_summary)"},{"path":"/reference/plot_r0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualise change in R0 — plot_r0","text":"sweep_summary Output summarise_results().","code":""},{"path":"/reference/plot_r0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualise change in R0 — plot_r0","text":"ggplot object.","code":""},{"path":"/reference/plot_r0.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Visualise change in R0 — plot_r0","text":"Sophie Meakin","code":""},{"path":"/reference/scenario_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a specified number of simulations with identical parameters. — scenario_sim","title":"Run a specified number of simulations with identical parameters. — scenario_sim","text":"Run specified number simulations identical parameters.","code":""},{"path":"/reference/scenario_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a specified number of simulations with identical parameters. — scenario_sim","text":"","code":"scenario_sim(   n_sim,   prop_pep,   rel_risk,   hrc_mu,   hrc_disp,   lrc_mu,   lrc_disp,   p_hrc_case,   p_lrc_case,   n_initialcases,   cap_max_gen,   cap_max_cases )"},{"path":"/reference/scenario_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a specified number of simulations with identical parameters. — scenario_sim","text":"prop_pep Proportion high-risk contacts receive PEP rel_risk Relative risk high-risk contact becoming case receiving PEP hrc_mu Average number high-risk contacts hrc_disp Dispersion parameter number high-risk contacts lrc_mu Average number low-risk contacts lrc_disp Dispersion parameter number low-risk contacts p_hrc_case Probability high-risk contact becomes case p_lrc_case Probability low-risk contact becomes case n_initialcases Integer number initial cases cap_max_gen Stop simulation many generations reached cap_max_cases Stop simulation many cases reached nsim Number simulations run","code":""},{"path":"/reference/scenario_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a specified number of simulations with identical parameters. — scenario_sim","text":"data.frame containing results multiple simulations.","code":""},{"path":"/reference/scenario_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run a specified number of simulations with identical parameters. — scenario_sim","text":"Joel Hellewell, Sophie Meakin","code":""},{"path":"/reference/summarise_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise results from parameter sweep — summarise_results","title":"Summarise results from parameter sweep — summarise_results","text":"Summarise results parameter_sweep scenario iteration.","code":""},{"path":"/reference/summarise_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise results from parameter sweep — summarise_results","text":"","code":"summarise_results(sweep_df)"},{"path":"/reference/summarise_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise results from parameter sweep — summarise_results","text":"sweep_df data.frame, output pepbp::parameter_sweep().","code":""},{"path":"/reference/summarise_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise results from parameter sweep — summarise_results","text":"data.frame columns: scenario: scenario id iter: iteration id outbreak_size: total cases n_pep: total number HRCs received PEP r0: average number secondary cases","code":""},{"path":"/reference/summarise_results.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarise results from parameter sweep — summarise_results","text":"Joel Hellewell, Sophie Meakin","code":""}]
